<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-113086304-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>Dex Personal Website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="Programming, Technology, Algorithm">
<meta property="og:type" content="website">
<meta property="og:title" content="Dex Personal Website">
<meta property="og:url" content="http://dexdexinwang.github.io/DexWebSite/index.html">
<meta property="og:site_name" content="Dex Personal Website">
<meta property="og:description" content="Programming, Technology, Algorithm">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dex Personal Website">
<meta name="twitter:description" content="Programming, Technology, Algorithm">
  
    <link rel="alternate" href="/DexWebSite/atom.xml" title="Dex Personal Website" type="application/atom+xml">
  
  
    <link rel="icon" href="/DexWebSite/images/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/DexWebSite/css/style.css">
  <link rel="stylesheet" href="/DexWebSite/css/highlight.css">
  <script>
  let antiquityStorage = window.sessionStorage.getItem('antiquitySessionStorage');
  if (antiquityStorage == '' || antiquityStorage == null) {
    var antiquityLoader = '<div id="loaderbox"><div class="loader"><div class="load-roll"><div class="load-top"></div><div class="load-right"></div><div class="load-bottom"></div></div></div></div>';
    document.write(antiquityLoader);
    document.body.style.overflow = 'hidden'
  }
  </script>
</head>
</html>
<body>
  <div id="fullpage" class="mobile-nav-left">
    
      <div id="wrapper" style="background-image: url(/DexWebSite/images/bg.jpg)" title="background">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-left">
      
        <a class="nav-item" href="/DexWebSite/" title>Home</a>
      
        <a class="nav-item" href="/DexWebSite/../PersonalWebSite/" title>Background</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-left">
        <section id="main">
  
    <article id="post-Design-Data-Intensive-Note-5" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-5/">Design Data-Intensive Note #5</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-5/" class="article-date">
  <time datetime="2020-10-12T03:33:00.000Z" itemprop="datePublished">2020-10-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/System-Design/">System Design</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h3><p>Replication means keeping a copy of the same data on multiple machines that are connected via a network by 3 reasons.</p>
<ul>
<li>To keep data geographically close to your users. (reduce latency)</li>
<li>To allow the system to continue working even if some of its parts have failed (increase availability)</li>
<li>TO scale out the number of machines that can serve read query. (increase scalability)</li>
</ul>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Design-Data-Intensive-Note-4" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-4/">Design Data-Intensive Note #4</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-4/" class="article-date">
  <time datetime="2020-10-12T03:33:00.000Z" itemprop="datePublished">2020-10-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/System-Design/">System Design</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Encoding-and-Evolution"><a href="#Encoding-and-Evolution" class="headerlink" title="Encoding and Evolution"></a>Encoding and Evolution</h3>
      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Design-Data-Intensive-Note-3" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-3/">Design Data-Intensive Note #3</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-3/" class="article-date">
  <time datetime="2020-10-12T02:13:00.000Z" itemprop="datePublished">2020-10-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/System-Design/">System Design</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Storage-and-Retrieval"><a href="#Storage-and-Retrieval" class="headerlink" title="Storage and Retrieval"></a>Storage and Retrieval</h3><p>On the most fundamental level, a database needs to do two things: when you give it some data, it should store the data, and when you ask it again later, it should give the data back to you.</p>
<p><strong>In order to tune a storage engine to perform well on your kind of workload, you need to have a rough idea of what the storage engine is doing under the hood.</strong> <br></p>
<h4 id="Data-Structure"><a href="#Data-Structure" class="headerlink" title="Data Structure"></a>Data Structure</h4><p>Assume there is Get() and Set() functions to save and get values from database. <br></p>
<h6 id="Append"><a href="#Append" class="headerlink" title="Append"></a>Append</h6><p>Each Set() only append new updated values to the end of the file that corresponding to key value. It is very efficient. Many databases internally use a <strong>log</strong>, which is an append-only data file. <br></p>
<p><em>Log</em> is used in the more general sense: an append-only sequence of records. It doesn’t have to be human-readable; it might be binary and intended only for other programs to read. <br></p>
<p><em>How to avoid eventually running out of dist spack?</em> <br><br>A good solution is to break the log into segments of a certain size by closing a segment file when it reaches a certain size, and make subsequent writes to a new segment file. Then, we can perform compaction on these segments.<br></p>
<p>Compaction means throwing away duplicate keys in the log, and keeping only the most recent update for each key.<br></p>
<p>Implementations:</p>
<ul>
<li>File format: Binary format will be faster</li>
<li>Deleting records: Delete action will apeend a special delection record to the data file as <em>“tombstone”</em>. When log segments are merged, the tombstone tells the merging process to discard any previous values for the deleted key.</li>
<li>Crash recovery: in-memory hash maps will lost if database is restarted. They system will record by reading the entire segment file. It is painful to take a long time.</li>
<li>Partially written read: Use checksums to detecte and ignore corrupted parts</li>
<li>Concurrentcy contry: one writing thread, multiple reading threads.</li>
</ul>
<h6 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h6><p>In general, Get() method will search a value from the start record to the end record. O(n). Index could be used to reduce the cost.</p>
<p>An Index is an additional structure that is derived from the primary data. Index could be added or removed, it does not affect the contents of the database; it only affects the performance of queries. Well-chosen indexes speed up read queries, but every index slows down writes.<br></p>
<p><strong>Hash Indexes</strong></p>
<p>Key-value stores are quite similar to the dictionary type which is usually implemented as a In-Memory hash map. (key, byte offset). <br></p>
<p>Limitations:</p>
<ul>
<li>Hashmap must fit in memory becuase of a lot of random access I/O.</li>
<li>Range queries are not efficient.</li>
</ul>
<p><strong>B-Trees</strong></p>
<p>The most common type of index is B-Tree which breaks the database down into fixed-size blocks or pages, traditionally 4KB in size, and read or write one page at a time. <br></p>
<p>Each page can be identified using an address or location, which allows one page to refer to another – similar to a pointer, but on disk instead of in memory.<br></p>
<p>Structure: <br><br>One page is designated as the root of the B-tree; whenever you want to look up a key in the index, you start here. The page contains several keys and references to child pages. Each child is responsible for a continuous range of keys, and the keys between the references indicate where the boundaries between those ranges lie. <br></p>
<p>The number of references to child pages in one page of the B-tree is called the <em>branching factor</em>.<br></p>
<p>The B-Tree algorighm ensure the tree remins balanced: a B-tree with n keys always has a depth of O(logn).</p>
<p>It is very common to have secondary indexes to have multiple search keys.</p>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Design-Data-Intensive-Note-2" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/10/Design-Data-Intensive-Note-2/">Design Data-Intensive Note #2</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/10/Design-Data-Intensive-Note-2/" class="article-date">
  <time datetime="2020-10-11T04:10:00.000Z" itemprop="datePublished">2020-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/System-Design/">System Design</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Chapter-2-A-Range-of-General-Pupose-Data-Models"><a href="#Chapter-2-A-Range-of-General-Pupose-Data-Models" class="headerlink" title="Chapter 2 -  A Range of General-Pupose Data Models"></a>Chapter 2 -  A Range of General-Pupose Data Models</h3><p>Data models will affect “How the software is written.” and “How we think about the problem that we are solving.”<br></p>
<p>Most applications are built byu layering one data model on top of another. For each layer, the key question is: <em>How is it represented in terms of the next-lower layer?</em> Each layer hides the complexity of the layers below it by providing a clean data modal. <br></p>
<h4 id="Relational-Model-SQL"><a href="#Relational-Model-SQL" class="headerlink" title="Relational Model - SQL"></a>Relational Model - SQL</h4><p>SQL, data is origanized into relations(tables) where each relation is an unordered collection of tuples(rows). The roots of relational databases lie in business data processing such as <em>transaction processing</em> and <em>batch processing</em>.<br></p>
<p><strong>Object-Relational Mismatch</strong></p>
<p>An awkward translation layer is required between the objects in the applciation code and the database model of tables, rows, and columns. The disconnect between the models is sometimes called an <strong>impedance mismatch</strong>.</p>
<p>E.g. Saving Resume Solutions:</p>
<ol>
<li><p>SQL requires normalization which ask more tables to save one resume such as positions or educations tables. <br></p>
</li>
<li><p>New SQL supports for structured dataypes and XML data, it allowed multi-valued data to be stored within a single row. <br></p>
</li>
<li><p>Encode jobs, education, and contact infor as a JSON or XML doument and store it on a text column in the database like documentation database.</p>
</li>
</ol>
<p>The JSON representation has better <em>locality</em> than the multi-table schema which may query multiple tabels to get data because of normalization(reduced duplicated data). In JSON, all the relevant infomraiton is in one place, and one query is sufficient, but more <em>duplicated human-meaningful information</em>.</p>
<h4 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h4><p>NoSQL(Not Only SQL) driving:</p>
<ul>
<li>A need for greater scalability than relational databases can easily achieve, including very large datasets or very high write throughput.</li>
<li>A widespread perfermance for free and open source software over commercial database products</li>
<li>Specialized query opertions that are not well supported by the relaional model</li>
<li>Frustraion with the restrictiveness of relational schemas, and desire for a more dynamic and expressive data modal.</li>
</ul>
<h4 id="Relational-Versus-Document-Databases"><a href="#Relational-Versus-Document-Databases" class="headerlink" title="Relational Versus Document Databases"></a>Relational Versus Document Databases</h4><p><strong>Document Data Model</strong></p>
<p>Normally, it is regarded as “schemaless” or “schema-on-read”. It is applicable for document-like structure such as a tree of One-To-Many relationships.</p>
<p> Advantages: </p>
<ul>
<li>Schema flexibility</li>
<li>Better performance due to locality </li>
<li>For some applications it is closer to the data structures used by the application</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Cannot refer directly to a nested item within a document. (However, as long as documents are not too deeply nested, that is not usually a problem).</li>
<li>Poor support for joins to support Many-To-Many in document databases. (Some applications does not require join method).</li>
</ul>
<p><strong>Relational Data Model</strong></p>
<p>It is regarded as “schema-on-write”.</p>
<p>Advantages:</p>
<ul>
<li>Better support for joins.</li>
<li>Many-To-One and Many-To-Many relationships</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>impedance mismatch</li>
<li>less locality</li>
</ul>
<h4 id="MapReduce-Quering"><a href="#MapReduce-Quering" class="headerlink" title="MapReduce Quering"></a>MapReduce Quering</h4><p><em>MapReduce</em> is a programming model for processing large amounts of data in bulk across many machines. The logic of the query is expressed with snippets of code, which are called repeatedly by the processing framework. It is based on the map (collect) and reduce (fold or inject) functions that exists in many functional Programming languages.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//SQL</span><br><span class="line">SELECT date_trunc(&apos;month&apos;, observation_timestamp) AS observation_month,</span><br><span class="line">sum(num_animals) AS total_animals</span><br><span class="line">FROM observations</span><br><span class="line">WHERE family = &apos;Sharks&apos;</span><br><span class="line">GROUP BY observation_month;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//MongoDB</span><br><span class="line">db.observations.mapReduce(</span><br><span class="line">	function map() &#123;</span><br><span class="line">    	var year = this.observationTimestamp.getFullYear();</span><br><span class="line">        var month = this.observationTimestamp.getMonth()+1;</span><br><span class="line">        emit(year + &quot;-&quot; + month, this.numAnimals);</span><br><span class="line">    &#125;,</span><br><span class="line">    function reduce(key, values) &#123;</span><br><span class="line">    	return Array.sum(values);</span><br><span class="line">    &#125;,</span><br><span class="line">	&#123;</span><br><span class="line">    	query: &#123;family:&quot;Sharks&quot;&#125;,</span><br><span class="line">        out: &quot;monthlySharkReport&quot;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="Graph-Like-Data-Models"><a href="#Graph-Like-Data-Models" class="headerlink" title="Graph-Like Data Models"></a>Graph-Like Data Models</h4><p>Graph Data Models are created for the case that Many-To-Many relations are very common, and the data is more complex. <br></p>
<p>A graph consists of two kinds of objects: vertices (nodes or entities) and edges (relationships or arcs).</p>
<p>E.g. <br> </p>
<ul>
<li>Social Graphs</li>
<li>The Web Graph</li>
<li>Road or Rail Networks</li>
</ul>
<p><strong>Property Graphs</strong></p>
<p>Each vertext consists of: </p>
<ul>
<li>A unique identifier</li>
<li>A set of outgoing edges</li>
<li>A set of incoming edges</li>
<li>A collection of properties (key-value paires)</li>
</ul>
<p>Each edge consists of:</p>
<ul>
<li>A unique identifier</li>
<li>The vertext at which the edge starts (the tail vertex).</li>
<li>The vertext at which the edge ends (the head vertex)</li>
<li>A label to describe the kind of relationship between the two vertices</li>
<li>A collection of properties (key-value pairs)</li>
</ul>
<h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><ol>
<li><p>Document databases target use cases where data comes in self–contained documents and relationships between one doument and another are rare.</p>
</li>
<li><p>Graph databases go in the opposite direction, targeting use cases where anything is potentially related to everything (Many-To-Many).</p>
</li>
</ol>
<p>Both of these are schemaless.</p>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Design-Data-Intensive-Applications" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/10/Design-Data-Intensive-Applications/">Design Data-Intensive Note #1</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/10/Design-Data-Intensive-Applications/" class="article-date">
  <time datetime="2020-10-10T23:36:00.000Z" itemprop="datePublished">2020-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/System-Design/">System Design</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Design-Data-Intensive-Aapplications"><a href="#Design-Data-Intensive-Aapplications" class="headerlink" title="Design Data-Intensive Aapplications"></a><a href="https://www.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/" target="_blank" rel="noopener">Design Data-Intensive Aapplications</a></h3><h5 id="Book-Goals"><a href="#Book-Goals" class="headerlink" title="Book Goals"></a>Book Goals</h5><ul>
<li>Learn how to make data systems scalable to support web or mobile apps with millions of users.</li>
<li>Make applications higly available and operationally robust.</li>
<li>Find ways of making systems easier to maintina in the long run, enven as they grow and as requirements and technologies change.</li>
<li>Know what goes on inside major websites and online services.</li>
</ul>
<h5 id="Chapter-1"><a href="#Chapter-1" class="headerlink" title="Chapter 1"></a>Chapter 1</h5><p>Chapter explors the Fundamentals: Reliable, Scalable, and Maintainable.</p>
<p>Many applications today are dat-intensive, as opposed to compute-intensive. Raw CPU power is rarely a limiting factor for these applications- bigger problems are usually the amount of data, the complexity of data, and the speed at which it is changing.</p>
<p>Data Intensive funcationality:</p>
<ul>
<li>Database: Store data so that they, or another application, can find it again later.</li>
<li>Caches: Remember the result of an expensive operation to speed up reads.</li>
<li>Search Indexes: Allow users to search data by keyword or filter in various ways.</li>
<li>Stream Processing: Send a message to another process, to be handled asynchronously</li>
<li>Batch Processing: Periodically crunch a large amount of accumulated data.</li>
</ul>
<h6 id="Reliability"><a href="#Reliability" class="headerlink" title="Reliability"></a>Reliability</h6><p>The System should continue to work correctly (performing the correct fucntion at the desired level of performance) even in the face of adversity （hardware or software faults, and even human error). <br></p>
<p><strong>Software Expections (working correctly, continueing to work correctly, even when things go wrong.)</strong> <br></p>
<ul>
<li>The application performs the function that the user expected.</li>
<li>It can tolerate the suer making mistakes or using the software in unexpected ways.</li>
<li>Its performance is good enough for the required use case, under the expected load and data volumn.</li>
<li>The system prevents any unauthorized access and abuse.</li>
</ul>
<p><em>Faults</em>, is usually defined as one component of the system deviating from its expectation.<br></p>
<p><em>Fault-tolerant</em>, systems anticipate faults and can cop with them, because of the limited budget, the systems can only handle certain types of faults.<br></p>
<p><em>Failure</em>, it is when the system as a whole stops providing the required service to the suer. It’s possible to reduce the probaility of a failure to 0, but not fault.<br></p>
<p><strong>Hardware Faults</strong></p>
<ul>
<li>Hard disks crash -&gt; RAID configuration</li>
<li>Power grid has a blackout -&gt; dual power supplies</li>
<li>RAM and CPU become faulty -&gt; hot-swappable RAM and CPU</li>
</ul>
<p><strong>Software Errors</strong></p>
<ul>
<li>A software bug that causes every instanceo f an pplication server to crash when given a particular bad input.</li>
<li>A runaway process that uses up some shared resource such as CPU, memory, disk, or network bandwidth.</li>
<li>A service that the system depends on that slows down, becomes unresponsive, or starts returning corruptecd resonses.</li>
<li>Cascading failures, where a small fault in one component triggers a fault in another component, which in turn triggers further faults.</li>
</ul>
<p>There is no quick solution to the problem of systematic faults in softwares:<br></p>
<ul>
<li>Carefully thinking about assumptions and interactions in the system</li>
<li>Thorough testing</li>
<li>Process isolation</li>
<li>Allowing processes to crash and restart</li>
<li>Measureing, monitoring, and analyzing system behavior in production.</li>
</ul>
<p><strong>Human Errors</strong></p>
<p>Congiruation errors by operators were the leading cause of errors. Even when they have the best intentions, humans are known to be unreliable. Some approaches should be considered to reduce human errors.</p>
<ul>
<li>Design a restrictive system in a way that minimizes opportunities for error.</li>
<li>Decouple the places where people make the most mistakes from the palces where they can cause failures.</li>
<li>Test thoroughly at all levels, from unit tests to whole-system integration tests and manual tests. Automated testing is widely used, well understood, and especially valuable for covering corner cases that rarely arise in normal operation. </li>
<li>Allow quick and easy recovery from human errors, to minimize the impact in the case of a failure.</li>
<li>Set up detailed and clear monitoring, such as performance metrices and error rates. In other engineering disciplines this is referred to as <strong>telemetry</strong>. </li>
<li>Implement good management practices and training</li>
</ul>
<h6 id="Scalability"><a href="#Scalability" class="headerlink" title="Scalability"></a>Scalability</h6><p>As the system grows (in data volume, traffice volume, or complexity), these should be reasonable ways of dealing with that growth.<br></p>
<p>Scalability is the term we use to describe a system’s ability to cope with increased load. Consider questions: “If the system grows in a particular way, what are our options for coping with the growth?” and “How can we add computing resources to handle the additional load?”</p>
<p><strong>Describing Load</strong> <br><br>Load can be described with a few numbers which we call load parameters: <br> </p>
<ul>
<li>Request per second to a web server</li>
<li>The ratio of reads to writes in a database.</li>
<li>The number of simultaneously active users in a chat room</li>
<li>The hit rate on a cache</li>
</ul>
<p><strong>Descreibing performance</strong> <br></p>
<ul>
<li>When you increase a load parameter and keep the system resources unchanged, how is the performance of your system affected?</li>
<li>WHen you increase a load parameter, how much do you need to increase the resources if you want to keep the performance unchanged? </li>
</ul>
<p>We need to think of response time not as a single number, but as a distribution of values that you can measure. It’s common to see the average response time of a service reported. (Strictly speaking, the term “average” doesn’t refer to any particular formular, but in practice it is usually understood as the arithmetic mean: given n values, andd up all the valuess, and divide by n.) <br></p>
<p>Usually, it is better to use percentiles which could find median (50th), the tail latencie for important users who has more data (99th), or the best one (1th). <br></p>
<p>Also, percentiles are often used in service level objective(SLOs)and service level agreements(SLAs), contracts that define the expected performance and availability of a service. <br></p>
<p>As a server can only process a small number of things in parallel, it only takes a small number of slow requests to hold up the processing of subsequent requests - an affect sometimes known as head-of-line blocking. Hence, it is important to <em>measure response time on the client side</em>.</p>
<p><strong>Approaches for Coping with Load</strong></p>
<p>Architecture</p>
<ul>
<li>Scaling up (vertical sacling, moving to a more powerful machine)</li>
<li>Scaling out (horizontal scaling, distributing the load across multiple smaller machines). </li>
</ul>
<p>In sum, several fairly powerful machines can still be simpler and cheaper than a large number of small Virtual machines. There is no such thing as a generic, one-size-fits-all scalable architecture. <br> </p>
<p>Some systems are elastic, meaning that they can automatically add computing<br>resources when they detect a load increase, whereas other systems are scaled manually.<br></p>
<h6 id="Maintainability"><a href="#Maintainability" class="headerlink" title="Maintainability"></a>Maintainability</h6><p>Over time, many different people will work on the system (engineering and operations, both maintaining current behavior and adapting the system to new use cases), and they should all be able to work on it _productively.<br></p>
<p>It is well known that the majority of the cost of software is not in its initial development, but in its ongoing maintenance. <br></p>
<ul>
<li>fix bugs</li>
<li>keeping its systems operational</li>
<li>investigating failures</li>
<li>adapting it to new platforms</li>
<li>modifying it for new use cases</li>
<li>repaying technical debt</li>
<li>adding new features</li>
</ul>
<p>Many people working on software systems dislike maintenance of “legacy systems” that could be avoided by 3 design principles: <br></p>
<p><strong>Operability</strong> <br><br>Make it easy for operations teams to keep the system running smootthly. <br></p>
<ul>
<li>Monitoring the health of the system and quickly restoring service if it goes into a bad state</li>
<li>Tracking down the cause of problems, such as system failures or degraded performance</li>
<li>Keeping software and platforms up to date, including security patches</li>
<li>Keeping tabs on how different systems affect each other, so that a problematic change can be avoided before it causes damage</li>
<li>Anticipating future problems and solving them before they occur</li>
<li>Establishing good practices and tools for deployment, configuration management, and more</li>
<li>performing complex maintenance tasks, such as moving an application from one platform to another</li>
<li>Maintaining the security of the system as configuration changes are made</li>
<li>Defining processes that make operations predictable and help keep the production envionment stable</li>
<li>Preserving the organization’s knowledge about the system, even as individual people come and go</li>
</ul>
<p>Good operability means making routine tasks easy, allowing the operations team to focus their efforts on high-value activities. Data systems can do various things to make routine tasks easy, including:</p>
<ul>
<li>Providing visibility into the runtime behavior and internals of the system, with good monitoring</li>
<li>Providing good support for automation and integration with standard tools</li>
<li>Avoiding dependency on individual machines (allowing machines to be taken<br>down for maintenance while the system as a whole continues running uninterrupted)</li>
<li>Providing good documentation and an easy-to-understand operational model (“If I do X, Y will happen”)</li>
<li>Providing good default behavior, but also giving administrators the freedom to<br>override defaults when needed</li>
<li>Self-healing where appropriate, but also giving administrators manual control<br>over the system state when needed</li>
<li>Exhibiting predictable behavior, minimizing surprises</li>
</ul>
<p><strong>Simplicity</strong> <br><br>Make it easy for new engineers to understand the system by removing as much as complexity as possible from the system. A software project mired in complexity is described as a big ball of mud. <br> </p>
<p>Making a system simpler does not necessarily mean reducing its functionality. it can also mean removing accidental complexity. <br></p>
<p><strong>Evolvability (extensibility, modifiability, plasticity)</strong><br><br>Make it easy for engineers to make changes to the system in the feature, adapting it for unanticipated use cases as requirements changes. <br></p>
<p>Agile working patterns provide a framework for adapting to change. The Agile community has also developed technical tools and patterns that are helpful when developing software in frequently changing environment, such as test-driven development (TDD) and refactoring.</p>
<h6 id="In-Sum"><a href="#In-Sum" class="headerlink" title="In Sum"></a>In Sum</h6><p>Reliability means making systems work correctly, even when faults occur. <br><br>Scalability means having strategies for keeping performance good, even when load<br>increases.<br><br>Maintainability has many facets, but in essence it’s about making life better for the engineering and operations teams who need to work with the system. <br></p>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-C-Lesson-6-Array" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/10/C-Lesson-6-Array/">Java Concurrency II</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/10/C-Lesson-6-Array/" class="article-date">
  <time datetime="2020-10-10T18:33:00.000Z" itemprop="datePublished">2020-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/Java-Programming-Language/">Java Programming Language</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Concurrency-Control-Base"><a href="#Concurrency-Control-Base" class="headerlink" title="Concurrency Control Base"></a>Concurrency Control Base</h3><h5 id="Data-Races"><a href="#Data-Races" class="headerlink" title="Data Races"></a>Data Races</h5><p>Data Races occure when two operations confilict with each other if they operate on the same memory location, and at least one of them is a write. Races are mostly treated as bugs in Java programs.</p>
<p>Data Race 3 Factors:</p>
<ul>
<li>More then one operations work on the same memory.</li>
<li>At lest one operation is a write </li>
<li>At lest two operations are concurrent.</li>
</ul>
<p>E.g.<br><figure class="highlight java"><figcaption><span>Data Race</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> sharedInt = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//Thread1:</span></span><br><span class="line">sharedInt = <span class="number">3</span></span><br><span class="line"><span class="comment">//Thread2: </span></span><br><span class="line">sharedInt += <span class="number">1</span></span><br><span class="line"><span class="comment">//Cannot predit the value of sharedInt. </span></span><br></pre></td></tr></table></figure></p>
<h5 id="Synchronization-for-Concurrency-in-Java"><a href="#Synchronization-for-Concurrency-in-Java" class="headerlink" title="Synchronization for Concurrency in Java"></a>Synchronization for Concurrency in Java</h5><p><a href="https://en.wikipedia.org/wiki/Synchronization" target="_blank" rel="noopener">Synchronization</a> is defined as a coordination of events to operate a system in unison in Wiki. <br></p>
<p>In Java, Synchronization is used to impose orders on concurrent events by 4 normal ways. <br></p>
<ul>
<li>Locks (synchronized)</li>
<li>Wait/Notify (condition synchronization)</li>
<li>Volatile</li>
<li>Concurrent Data Structure</li>
</ul>
<h5 id="Locks"><a href="#Locks" class="headerlink" title="Locks"></a>Locks</h5><p>Before introducing locks, two principles should be shown to understand locks.</p>
<p><strong>Critical section</strong>, a part of a multi-process program / threads that could not be concurrently executed by more than one of the procecesses / threads.</p>
<p><strong>Mutual exclusion</strong> defines a scenario that no more than one concurrent process in their critical section at the same time.</p>
<p>E.g. A toilet (Shared Memory, Critical Section) that could accessed by one and only one person (process/thread) in below steps:<br></p>
<ol>
<li>Person In <br></li>
<li>Lock Door <br></li>
<li>Do Something<br></li>
<li>Unlock Door<br></li>
<li>Person Out<br></li>
</ol>
<h5 id="Lock-Implementation-1-Synchronized"><a href="#Lock-Implementation-1-Synchronized" class="headerlink" title="Lock Implementation 1 - Synchronized"></a>Lock Implementation 1 - Synchronized</h5><p>In Java, one way to implement the mutual exclusion is using ‘Synchronized’ keyword. <br><br>Synchronized on static/non-static methods: <br></p>
<ul>
<li>synchronized on non-static mehtod = synchronized(this)</li>
<li>static synchronized = synchronized(Counter.calss) </li>
<li>synchronized(this)!= synchronized(Counter.calss)</li>
</ul>
<figure class="highlight java"><figcaption><span>Mutal Exclusion Implementation</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MutualExclusionClass</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Counter</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Counter</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = value;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">increase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="comment">//Mutual exclusion for critical section. </span></span><br><span class="line">			<span class="keyword">synchronized</span>(<span class="keyword">this</span>) &#123; <span class="comment">//synchronized should be work for object.</span></span><br><span class="line">				value++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//...</span></span><br><span class="line">			<span class="comment">//others are not locked.</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//Mutual exclusion for method. </span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">decrease</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			value--;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> value;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticCounter</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">int</span> value;</span><br><span class="line">		</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="comment">//Mutual exclusion for critical section. </span></span><br><span class="line">			<span class="keyword">synchronized</span>(Counter.class) &#123; <span class="comment">//synchronized should be work for static class.</span></span><br><span class="line">				value++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//...</span></span><br><span class="line">			<span class="comment">//others are not locked.</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//synchronize method means synchronize class</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">decrease</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">synchronized</span>(Counter.class) &#123;</span><br><span class="line">				value--;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">synchronized</span>(Counter.class) &#123;</span><br><span class="line">				<span class="keyword">return</span> value;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, the critical section could be a class, a function, or a section of code. It could describe the critical section as Coarse Granularity Lock (CGL) or Fine Granularity Lock (FGL). <br></p>
<p><strong>Conditions for Deadlock</strong>: <br></p>
<ul>
<li>Mutal Exclusion：At least one resource must be held in a non-shareable mode. Only one process can use the resource at any given instance of time. </li>
<li>Hold and Wait or Resource Holding: A process is currently holding at least one resource and requesting additional resources which are being held by another processes.</li>
<li>No Preemption: a resource can be released only voluntarily by the process holding it. </li>
<li>Circular Wait.</li>
</ul>
<p>E.g. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">P1: 				P2:</span><br><span class="line">lock1.lock();		lock2.lock();</span><br><span class="line">lock2.lock()		lock1.lock();</span><br><span class="line">lock2.unlock();		lock1.unlock();</span><br><span class="line">lock1.unlock();		lock2.unlock();</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>Create Lock</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Lock lock = <span class="keyword">new</span> ReentrantLock(); <span class="comment">// Default lock in all objects.</span></span><br><span class="line">   lock.lock();</span><br><span class="line">   <span class="keyword">try</span>&#123;</span><br><span class="line">   	<span class="comment">//access the resource protected by this lock.</span></span><br><span class="line">   &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">   	lock.unlock();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>Live Lock</strong> will happen if each side is actively resolving the problem (back off and retry). <br></p>
<h5 id="Lock-Implementation-2-Atomicity-（Volatile）"><a href="#Lock-Implementation-2-Atomicity-（Volatile）" class="headerlink" title="Lock Implementation 2 - Atomicity （Volatile）"></a>Lock Implementation 2 - Atomicity （Volatile）</h5><p>The volatile keyword guarantees visibility (semantically, happens-before), much like acquiring and releasing a lock. </p>
<figure class="highlight java"><figcaption><span>Volatile Key</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VolatileExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">false</span>; <span class="comment">// volatile will avoid infinity loop for Java compile to do</span></span><br><span class="line">													<span class="comment">// optimization.</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">while</span> (!flag) &#123;</span><br><span class="line">				System.out.println(<span class="string">"The thread is running."</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"The thread is finished."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyRunnable());</span><br><span class="line">		t.start();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			t.sleep(<span class="number">3000</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		flag = <span class="keyword">true</span>; <span class="comment">// Will pass signal between threads and that will create alive locks.</span></span><br><span class="line">		System.out.println(<span class="string">"Main thread is finished."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Atomicity of value++ is not preserved! volatile int value = 0; thread 1:</span></span><br><span class="line"><span class="comment">	 * value++; // read * 10x slower, write * 70x slower</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * thread 2: value++;</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * value ==2 ?</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * Because volatile can only guarantee single read/write operation is atomic.</span></span><br><span class="line"><span class="comment">	 * Bottom line: read only or write only use cases are fine. if there a</span></span><br><span class="line"><span class="comment">	 * read-then-update case, if you really need atomicity for value++, check</span></span><br><span class="line"><span class="comment">	 * AtomicInteger/AtomicLong classes. However, they are expensive. Use it only if</span></span><br><span class="line"><span class="comment">	 * you really know why you need it.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Lock-Implementation-3-Condition-Synchronization"><a href="#Lock-Implementation-3-Condition-Synchronization" class="headerlink" title="Lock Implementation 3 - Condition Synchronization"></a>Lock Implementation 3 - Condition Synchronization</h5><p>Sometime, a thread locked a resource and require I/O from other processes or threads. Hence, the are 3 ways to handle locked resource.</p>
<ul>
<li>Keep wait (very low efficiency)</li>
<li>Periodic check and go ( better efficiency, but may delay, it depends on period)</li>
<li>Use a service and notification, it will send message when the required I/O comes. (high efficency, almost no delay)</li>
</ul>
<p>For notification mechanism:</p>
<ul>
<li>Allow threads to wait on a condition</li>
<li>Allow a thread satisfieds the condition to notify all waiting threads</li>
</ul>
<p>A condition variable basically is a container of threads that are waiting on a certain condition with 3 operations: </p>
<ul>
<li>wait()</li>
<li>notify()</li>
<li>notifyAll()</li>
</ul>
<p>E.g. Producer Consumer Problem with Queue<br></p>
<p>As a consumer, if the queue is empty, <em>Wait</em> for it to be not empty, then poll one element from resource queue. <br><br>As a Producer, if the queue is full, <em>Wait</em> for it to be not full, then offer one element to it. <br></p>
<p>Build a blocking queue, such that</p>
<ul>
<li>When the queue is empety, consumer() will wait until produce() provide one element.</li>
<li>When the queue is full, producer() will wait until consumer() release one element. </li>
</ul>
<p>Blocking Queue:<br>Mutual exclusive -&gt; use locks<br>Wait -&gt; condition syunchronization</p>
<p>Each Java Object is a Monitor.<br>Each Java Object provides two concurrency permises: one lock -&gt; synchnoized, one condition -&gt; wait()</p>
<p><em>Monitor</em>:<br>In short, there are two queues controlling the access to enter the room:</p>
<ol>
<li>lock queue, there is only one thread at a time from the queue can enter</li>
<li>wait queue, there is a queue for the condition provided, all the threads wait(), is in the queue, and wait for the notify() call to remove from the wait queue.</li>
</ol>
<figure class="highlight java"><figcaption><span>Condition Synchronization</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	Q q;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(Q q)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.q = q;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		q.put(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	Q q;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(Q q)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.q = q;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(q.take());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Q</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Queue&lt;Integer&gt; q;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> limit;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Q</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.q = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">		<span class="keyword">this</span>.limit = limit;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Integer ele)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (q.size() == limit) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				wait();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (q.size() == <span class="number">0</span>) &#123;</span><br><span class="line">			notifyAll();</span><br><span class="line">		&#125;</span><br><span class="line">		q.offer(ele);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Integer <span class="title">take</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (q.size() == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				wait();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (q.size() == limit) &#123;</span><br><span class="line">			notifyAll();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> q.poll();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerAndConsumerExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Q q = <span class="keyword">new</span> Q(<span class="number">20</span>);</span><br><span class="line">		List&lt;Thread&gt; threads = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">			threads.add(<span class="keyword">new</span> Thread(<span class="keyword">new</span> Producer(q)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">			threads.add(<span class="keyword">new</span> Thread(<span class="keyword">new</span> Consumer(q)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Thread t : threads) &#123;</span><br><span class="line">			t.start();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Java-Base-Principle-III" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/10/03/Java-Base-Principle-III/">Java Concurrency I</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/10/03/Java-Base-Principle-III/" class="article-date">
  <time datetime="2020-10-03T21:30:00.000Z" itemprop="datePublished">2020-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/Java-Programming-Language/">Java Programming Language</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Concurrency-Principles"><a href="#Concurrency-Principles" class="headerlink" title="Concurrency Principles"></a>Concurrency Principles</h3><h5 id="Concurrency-VS-Parallel"><a href="#Concurrency-VS-Parallel" class="headerlink" title="Concurrency VS Parallel"></a>Concurrency VS Parallel</h5><p>Concurrency: It is a semantica concpetion to allow multiple tasks run simultaneously. The time is an abstract concept. It could not guarantee which task is executed first or sencond. Norally, there are multiple programs or functions . </p>
<p>parallel: It is an implementition level conception to allow multiple tasks <strong>phycially</strong> run simultanenously. Normally, there are multiple executors.</p>
<h5 id="Multiprocess-VS-Multithread"><a href="#Multiprocess-VS-Multithread" class="headerlink" title="Multiprocess VS Multithread"></a>Multiprocess VS Multithread</h5><p>One computer could execute mutiple processes, and each process could contains multiple threads. </p>
<p>In Java: <br></p>
<p>Process is an independed execution of instructions with independed resource such as memory, stack, heap or cup. Different process could communicate through interprocess communication (IPC). <br></p>
<p>Thread is an independed execution of instructiosn with shared memory, but individual stack, counter, and register status. Different thread could communicate through reading/writing shared memory which should take care of ‘Communication overhead’, ‘Resource Isolation’, and ‘Creation/desotry overhead’. These could be controlled by concurrency control.<br></p>
<p>Hence, Java concurrency is focusing on multi-thread cases in real life. A Java application runs by default in one process. Within a Java application you work with several threads to achieve parallel processing or asynchronous behavior.<br></p>
<p><a href="http://tutorials.jenkov.com/java-concurrency/index.html" target="_blank" rel="noopener">Why Multi-Threads?</a> <br></p>
<ul>
<li>Better utilization of a single CPU.</li>
<li>Better utilization of multiple CPUs or CPU cores.</li>
<li>Better user experience with regards to responsiveness.</li>
<li>Better user experience with regards to fairness.</li>
</ul>
<h5 id="Multi-Threads-in-Java"><a href="#Multi-Threads-in-Java" class="headerlink" title="Multi-Threads in Java"></a>Multi-Threads in Java</h5><p>In java development environment, everything is an object even a thread. Hence, a new thread could be created by 3 steps:</p>
<ul>
<li>Create a thread object</li>
<li>Assign task to the created thread object</li>
<li>Execut the thread. </li>
</ul>
<figure class="highlight java"><figcaption><span>Create Threads</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadTester</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ThreadTester</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"inherited class : "</span> + <span class="keyword">this</span>.id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadTester2</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ThreadTester2</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"runnable class : "</span> + <span class="keyword">this</span>.id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiThreadsTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"------------Method 1 to create a thread------------"</span>);</span><br><span class="line">		<span class="comment">// Create Thread Method 1.</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">			Thread t = <span class="keyword">new</span> Thread(String.valueOf(i)) &#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					System.out.println(getName());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">			t.start(); <span class="comment">// Any thread could be started once and only once.</span></span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">			 * try &#123; t.join(); &#125; catch (InterruptedException e) &#123; // TODO Auto-generated</span></span><br><span class="line"><span class="comment">			 * catch block e.printStackTrace(); &#125;</span></span><br><span class="line"><span class="comment">			 */</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"------------Method 2 to create a thread------------"</span>);</span><br><span class="line">		<span class="comment">// Create Thread Method 2 with inherited class.</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">			Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadTester(i));</span><br><span class="line">			t.start();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"------------Method 3 to create a thread------------"</span>);</span><br><span class="line">		<span class="comment">// Create Thread Method 3 with an interface because the some thread method may</span></span><br><span class="line">		<span class="comment">// be inherited another class.</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">			Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadTester2(i));</span><br><span class="line">			t.start();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><a href="https://www.baeldung.com/java-daemon-thread" target="_blank" rel="noopener">Thread Type in Java</a>:</strong></p>
<p>User threads, are high-priority threads. The JVM will wait for any user thread to complete its task before terminating it. All default created threads in Java are user threads.<br></p>
<p>Daemon threads are low-priority threads whose only role is to provide services to user threads such as garbage collection. <br></p>
<p><strong><a href="https://www.geeksforgeeks.org/daemon-thread-java/" target="_blank" rel="noopener">Property</a></strong> <br></p>
<ul>
<li>They can not prevent the JVM from exiting when all the user threads finish their execution.</li>
<li>JVM terminates itself when all user threads finish their execution</li>
<li>If JVM finds running daemon thread, it terminates the thread and after that shutdown itself. JVM does not care whether Daemon thread is running or not.</li>
<li>It is an utmost low priority thread.</li>
</ul>
<figure class="highlight java"><figcaption><span>Create Daemon Threads</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">DaemonThread</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(name);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(Thread.currentThread().isDaemon()) &#123;</span><br><span class="line">			System.out.println(<span class="keyword">this</span>.getName() + <span class="string">" is a daemon thread!"</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			System.out.println(<span class="keyword">this</span>.getName() + <span class="string">" is a user thread!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		DaemonThread t1 = <span class="keyword">new</span> DaemonThread(<span class="string">"t1"</span>); </span><br><span class="line">        DaemonThread t2 = <span class="keyword">new</span> DaemonThread(<span class="string">"t2"</span>); </span><br><span class="line">        DaemonThread t3 = <span class="keyword">new</span> DaemonThread(<span class="string">"t3"</span>); </span><br><span class="line">      </span><br><span class="line">        <span class="comment">// Setting user thread t1 to Daemon </span></span><br><span class="line">        t1.setDaemon(<span class="keyword">true</span>); </span><br><span class="line">              </span><br><span class="line">        <span class="comment">// starting first 2 threads  </span></span><br><span class="line">        t1.start();  </span><br><span class="line">        <span class="comment">//setDaemon() cannot be called when the thread is started. otherwise, java.lang.IllegalThreadStateException</span></span><br><span class="line">        <span class="comment">//t1.setDaemon(true);  </span></span><br><span class="line">        t2.start(); </span><br><span class="line">  </span><br><span class="line">        <span class="comment">// Setting user thread t3 to Daemon </span></span><br><span class="line">        t3.setDaemon(<span class="keyword">true</span>);  </span><br><span class="line">        t3.start();   </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><a href="https://www.baeldung.com/java-thread-lifecycle" target="_blank" rel="noopener">A Thread’s life cycle</a>:</strong></p>
<p>The main methos is Start() : mark a thread as “ready to run” state -&gt; put it into the ‘ready to run queue’ and wait for the scheduler to assign its time frame(quota) for running -&gt; end of quota or state change by different even:</p>
<ul>
<li>Sleep() : remove from the ready to run queue, and move to sleeping thread pool</li>
<li>Object.Wait() : removed from the ready to run queue, and move to the conditions’ queue for signal to put back to the ready queue.</li>
<li>Yield() : did not change the ready to run state, but preempt itself the current quota, put back to the ready-to-run queue again for the next quota.</li>
</ul>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Algorithm-Interval" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/09/09/Algorithm-Interval/">Algorithm Interval</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/09/09/Algorithm-Interval/" class="article-date">
  <time datetime="2020-09-09T21:01:00.000Z" itemprop="datePublished">2020-09-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/Algorithm/">Algorithm</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Interval"><a href="#Interval" class="headerlink" title="Interval"></a>Interval</h3><p>Interval questions will consider the interval structure like below one. </p>
<figure class="highlight java"><figcaption><span>Interval</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interval</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> start;</span><br><span class="line">  <span class="keyword">int</span> end;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Interval</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.start = start;</span><br><span class="line">    <span class="keyword">this</span>.end = end;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>Easy Question</strong><br><br>Meeting Question gives two intervals AIntervals and BIntervals for two people, returns the earliest time slot that works for both of them with duration K. <br></p>
<p>Solution hits:</p>
<ul>
<li>Get overlap by start = max(AIntervals[i].start, BIntervals[i].start) and end = min(AIntervals[i].end, BIntervals[i].end)</li>
<li>Find the K is smaller or euqal to the end - start;</li>
</ul>
<p><strong>Medium Question</strong> <br></p>
<p>Most medium above interval questiosn will consider overlaps between multiple intervals (from 0 to n-1). It could be solved with PriorityQueue Pattern sorted by “Interval.End”, minHeap. It will indicates how many intervals have overlaps from index-0 to index-i. The normal time complexity will be O(nlogn), and space time complexity will be O(n). <br> </p>
<p>E.g.<br><br><a href="https://leetcode.com/problems/meeting-rooms-ii/" target="_blank" rel="noopener">Meeting Rooms II</a>: it asks the maximum number of meeting rooms are necessary for all intervals. The solution will consider  <br></p>
<figure class="highlight java"><figcaption><span>Meeting Rooms II</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minMeetingRooms</span><span class="params">(<span class="keyword">int</span>[][] intervals)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(intervals == <span class="keyword">null</span> || intervals.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Arrays.sort(intervals, (a, b) -&gt; (a[<span class="number">0</span>] == b[<span class="number">0</span>] ? a[<span class="number">1</span>] - b[<span class="number">1</span>]: a[<span class="number">0</span>] - b[<span class="number">0</span>]));</span><br><span class="line">    PriorityQueue&lt;Integer&gt; minHeap = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; intervals.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(minHeap.size() != <span class="number">0</span> &amp;&amp; minHeap.peek() &lt;= intervals[i][<span class="number">0</span>]) &#123;</span><br><span class="line">            minHeap.poll();</span><br><span class="line">        &#125;</span><br><span class="line">        minHeap.offer(intervals[i][<span class="number">1</span>]);</span><br><span class="line">        max = Math.max(minHeap.size(), max);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The Priority Queue pattern could also solve similar examples: “Maximum CPU Load” and “Employee Free Time”</p>
<figure class="highlight java"><figcaption><span>Maximum CPU Load</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Jobs: [[1,4,3], [2,5,4], [7,9,6]]</span></span><br><span class="line"><span class="comment">Output: 7</span></span><br><span class="line"><span class="comment">Explanation: Since [1,4,3] and [2,5,4] overlap</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMaxCPULoad</span><span class="params">(List&lt;Job&gt; jobs)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">if</span>(jobs == <span class="keyword">null</span> || jobs.size() == <span class="number">0</span>) &#123;</span><br><span class="line">	      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	    Collections.sort(jobs, (a,b)-&gt;(a.start == b.start ? a.end - b.end : a.start - b.start));</span><br><span class="line">	    <span class="keyword">int</span> currMaxLoad = <span class="number">0</span>;</span><br><span class="line">	    <span class="keyword">int</span> maxLoad = <span class="number">0</span>;</span><br><span class="line">	    PriorityQueue&lt;Job&gt; min = <span class="keyword">new</span> PriorityQueue&lt;&gt;((a,b)-&gt;(a.end - b.end));</span><br><span class="line">	    <span class="keyword">for</span>(Job j : jobs) &#123;</span><br><span class="line">	    	<span class="keyword">while</span>(!min.isEmpty() &amp;&amp; min.peek().end &lt;= j.start) &#123;</span><br><span class="line">	    		currMaxLoad -= min.poll().cpuLoad;</span><br><span class="line">	    	&#125;</span><br><span class="line">	    	min.offer(j);</span><br><span class="line">	    	currMaxLoad += j.cpuLoad;</span><br><span class="line">	    	maxLoad = Math.max(currMaxLoad, maxLoad);</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> maxLoad;</span><br><span class="line">	  &#125;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>Employee Free Time</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Input: Employee Working Hours=[[[1,3], [5,6]], [[2,3], [6,8]]]</span></span><br><span class="line"><span class="comment">Output: [3,5]</span></span><br><span class="line"><span class="comment">Explanation: Both the employess are free between [3,5].</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Interval&gt; <span class="title">findEmployeeFreeTime</span><span class="params">(List&lt;List&lt;Interval&gt;&gt; schedule)</span> </span>&#123;</span><br><span class="line">    List&lt;Interval&gt; arr = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(List&lt;Interval&gt; l : schedule) &#123;</span><br><span class="line">      <span class="keyword">for</span>(Interval i : l)&#123;</span><br><span class="line">        arr.add(i);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Interval&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Collections.sort(arr, (a,b)-&gt; (a.start - b.start));</span><br><span class="line">    <span class="keyword">int</span> currEnd = arr.get(<span class="number">0</span>).end;</span><br><span class="line">    PriorityQueue&lt;Interval&gt; min = <span class="keyword">new</span> PriorityQueue&lt;&gt;((a,b)-&gt;(a.end - b.end));</span><br><span class="line">    <span class="keyword">for</span>(Interval interval: arr)&#123;</span><br><span class="line">      <span class="keyword">while</span>(!min.isEmpty() &amp;&amp; min.peek().end &lt; interval.start) &#123;</span><br><span class="line">        currEnd = min.poll().end;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(min.isEmpty() &amp;&amp; currEnd &lt; interval.start) &#123;</span><br><span class="line">    	  result.add(<span class="keyword">new</span> Interval(currEnd, interval.start));</span><br><span class="line">      &#125;</span><br><span class="line">      min.offer(interval);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<p><strong>Optimized Soltion for Time complexity</strong><br></p>
<p>If the maximum number of ending time from all intervals is smaller enough. The question could be solved with 1D array with Max(intervals.end) value. The total time compelxity will be O(n*T) and space compelxity will be O(T) where T is Max(intervals.end) <br></p>
<figure class="highlight java"><figcaption><span>Maximum CPU Load</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Jobs: [[1,4,3], [2,5,4], [7,9,6]]</span></span><br><span class="line"><span class="comment">Output: 7</span></span><br><span class="line"><span class="comment">Explanation: Since [1,4,3] and [2,5,4] overlap</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findMaxCPULoad</span><span class="params">(List&lt;Job&gt; jobs)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(jobs == <span class="keyword">null</span> || jobs.size() == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Collections.sort(jobs, (a,b)-&gt;(a.start == b.start ? a.end - b.end : a.start - b.start));</span><br><span class="line">    <span class="keyword">int</span> size = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">for</span>(Job j: jobs) &#123;</span><br><span class="line">      size = Math.max(size, j.end);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[size+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(Job j : jobs) &#123;</span><br><span class="line">      <span class="keyword">int</span> load = j.cpuLoad;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = j.start ; i&lt;=j.end; i++) &#123;</span><br><span class="line">        arr[i] = arr[i] + load;</span><br><span class="line">        max = Math.max(max, arr[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">  &#125;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Algorithm-Bit-Operation" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/09/02/Algorithm-Bit-Operation/">Algorithm Bit Operation</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/09/02/Algorithm-Bit-Operation/" class="article-date">
  <time datetime="2020-09-02T19:02:00.000Z" itemprop="datePublished">2020-09-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/Algorithm/">Algorithm</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Bit-Operation"><a href="#Bit-Operation" class="headerlink" title="Bit Operation"></a>Bit Operation</h3><p>The least significant bit is most right bit because number comparation is based on bits from left to right. <br></p>
<p>The most significant bit (most left bit) is signature: <br></p>
<ul>
<li>0 is positive number <br></li>
<li>1 is negative number <br></li>
</ul>
<p>Two`s complement is used to make calculation for negative:<br>Use two`s complement to convert positive number as negative number. <br></p>
<p>e.g. change 1 to -1</p>
<ul>
<li>Get two`s complement of 1 <br></li>
<li>Add number 1 <br><br>e.g.<br>1       ==     0000 0000 0000 0000 0000 0000 0000 0001<br>-2       == 1111 1111 1111 1111 1111 1111 1111 1110<br>-1        == 1111 1111 1111 1111 1111 1111 1111 1111</li>
</ul>
<p><strong>Bit Operation:</strong> <br></p>
<ul>
<li>&amp;, AND                 if (true1 &amp;&amp; True2)</li>
<li>|, OR                 if (True || True2)</li>
<li>~, Two`s complement         (1-&gt;0 and 0-&gt; for each bit)</li>
<li>^, XOR                00-&gt;0; 11-&gt;0; 01 or 10-&gt; 1;</li>
<li>&lt;&lt; left shift            e.g. byte a = 0b 01000001    0b means bites    </li>
<li>>&gt; right shift    e.g. byte a = 0b 10000000    &gt;&gt;1   -&gt; 1100000  add 1 if the number is negative</li>
<li>>&gt;&gt; right shift     e.g. byte a = 0b 10000000    &gt;&gt;&gt;1  -&gt; 0100000 and 0 .</li>
</ul>
<p>Note: there is no “unsigned int” in JAVA before JAVA 8, but there is unsigned right shift.</p>
<p>Practical Use Cases:</p>
<ul>
<li><p>Bit Getter in kth: <br><br>  int bit = 1; <br><br>  bit = bit &lt;&lt; k ;  <br><br>  return x &amp;= bit <br></p>
</li>
<li><p>Big Setter int k: <br><br>  int bit = 1; <br><br>  bit = bit &lt;&lt; k; <br><br>  return x |= bit_setter; <br></p>
</li>
<li><p>Bit Divide by 2 <br><br>  int bit = 2; <br><br>  return bit &gt;&gt; 1; <br></p>
</li>
<li><p>Bit Count 1s <br><br>  int sum = 0 <br><br>  while(sum!=0) {sum++; n &amp;=(n-1);} <br> </p>
</li>
<li><p>Check only one 1 <br><br>  return (n&amp;(n-1)) == 0; <br></p>
</li>
<li><p>Keep Most right 1 <br><br>  (n &amp; (-n))  =  x <br></p>
</li>
<li><p>Prefix <br><br>  arr[i]^ = arr[i-1] <br></p>
</li>
<li><p>Get Complement <br></p>
</li>
</ul>
<figure class="highlight java"><figcaption><span>Get Complement</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">int</span> temp = n;</span><br><span class="line">     <span class="keyword">while</span>(temp != <span class="number">0</span>) &#123;</span><br><span class="line">       temp &gt;&gt;=<span class="number">1</span>;</span><br><span class="line">       len++;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">int</span> complement = (<span class="keyword">int</span>)Math.pow(<span class="number">2</span>,len) - <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">return</span> n ^ complement;</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
  
</article>

  
    <article id="post-Algorithm-Graph" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 itemprop="name">
      <a class="article-title" href="/DexWebSite/2020/06/22/Algorithm-Graph/">Algorithm Graph</a>
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/DexWebSite/2020/06/22/Algorithm-Graph/" class="article-date">
  <time datetime="2020-06-22T20:30:00.000Z" itemprop="datePublished">2020-06-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/DexWebSite/categories/Algorithm/">Algorithm</a>
  </div>

    
  </div>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h3 id="Graph"><a href="#Graph" class="headerlink" title="Graph"></a>Graph</h3><p>Each graph contains 3 elements:</p>
<ul>
<li>Node/State/Victor </li>
<li>Edge/Action</li>
<li>Direction/Undirected</li>
</ul>
<p>In Java, there are 3 data structures to represent given graphs (The example images belong to Intro to <a href="http://darknessneo20000.tripod.com/chapter23.pdf" target="_blank" rel="noopener">Algorithm:Chapter 23</a>)</p>
<ol>
<li>Adjacency Matrix</li>
</ol>
<p><img src="../images/AlgorithmGraph1.png" alt="alt"><br></p>
<p>Pros: Representation is easy to implement. Edge removal takes O(1) time. Queries like whether there is an edge from vertex ‘u’ to vertex ‘v’ are efficient and can be done O(1). <br><br>Cons: Consumes more O(V^2) Even if the graph is sparse. O(n^2) to do extension. <br></p>
<figure class="highlight java"><figcaption><span>Adjacency Matrix</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[][] matrix = <span class="keyword">new</span> <span class="keyword">int</span>[n][n];</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Adjacency List</li>
</ol>
<p><img src="../images/AlgorithmGraph2.png" alt="alt"><br></p>
<p>Pros: Space complexity = O(|V|+|E|). Adding a vertex/node to the graph is easier<br><br>Cons: Time complexity is O(V) to check whether there is an edge from a node to the other. (Compared to O(1) adjacent matrix).<br></p>
<figure class="highlight java"><figcaption><span>Adjacency List</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Class GraphNode &#123;</span><br><span class="line">	Int key;</span><br><span class="line">	List&lt;GraphNode&gt; neighbors;</span><br><span class="line">	<span class="function">Public <span class="title">GraphNode</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">		This.key = key;</span><br><span class="line">		Neighbors = <span class="keyword">new</span> ArrayList&lt;graphNode&gt;();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">List&lt;GraphNode&gt; graph = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br></pre></td></tr></table></figure>
<p><strong>The better structure of Adjacency List is going to use HashMap</strong></p>
<p>Pros: Good for sparse graph for space time complexity. Search time complexity if O(1).<br></p>
<figure class="highlight java"><figcaption><span>HashMap</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Class Node &#123;</span><br><span class="line">	<span class="keyword">int</span> key;</span><br><span class="line">	<span class="function">Public <span class="title">Node</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.key = key;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Map&lt;Node, Set&lt;Node&gt;&gt; graph = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br></pre></td></tr></table></figure>
<h5 id="Algorithm-Solutions"><a href="#Algorithm-Solutions" class="headerlink" title="Algorithm Solutions"></a>Algorithm Solutions</h5><ol>
<li>BFS1 (Breadth First Serach, is only applicable that edge weight is 1).</li>
</ol>
<p>Expend: Choose a node X to be expended. <br><br>Generate: Generate X neighbor node Ys; Reach out to its X all neighboring nodes.<br><br>Termination condition: do a loop until the queue is empty. <br><br>Data Stricture: Maintain a FIFO Queue, put all generated nodes in the queue.<br><br>Priorities:<br>-Each node could be expended one and only once.<br><br>-Each node can be generated once.(it allows to generate more then once, but it will have more cost).<br></p>
<ul>
<li>The time complexity of Queue will be O(n). <br></li>
</ul>
<p>E.g. <a href="https://leetcode.com/problems/clone-graph/" target="_blank" rel="noopener">Leetcode 133. Clone Graph</a></p>
<figure class="highlight java"><figcaption><span>Clone Graph</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">cloneGraph</span><span class="params">(Node node)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (node == <span class="keyword">null</span>) <span class="keyword">return</span> node;</span><br><span class="line">    Map&lt;Node, Node&gt; visited = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    Deque&lt;Node&gt; que = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    que.offerLast(node);</span><br><span class="line">    visited.put(node, <span class="keyword">new</span> Node(node.val, <span class="keyword">new</span> ArrayList()));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!que.isEmpty()) &#123;</span><br><span class="line">        Node target = que.pollFirst();    </span><br><span class="line">        <span class="keyword">for</span>(Node nei: target.neighbors) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!visited.containsKey(nei)) &#123;</span><br><span class="line">                visited.put(nei, <span class="keyword">new</span> Node(nei.val, <span class="keyword">new</span> ArrayList&lt;&gt;()));</span><br><span class="line">                que.offerLast(nei);</span><br><span class="line">            &#125;</span><br><span class="line">            visited.get(target).neighbors.add(visited.get(nei));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> visited.get(node);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>BFS2 (Best First Search, speicific exmaple <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" target="_blank" rel="noopener">Dijkstra Algorithm</a>, it requires non-negative eage weight.)</li>
</ol>
<p>Usage: Find a shortest path cost from a single node to any other nodes in a graph.<br>Expend: Choose a start node to be expend. <br><br>Generate: Expend node by following a certain gereration rule. <br><br>Termination condition: find a satisfied result or traverse all graph. <br><br>Data Structure: Priorirty Queue<br><br>Properties: </p>
<ul>
<li>Each node could be expended one and only once. <br></li>
<li>Each node could be generated more then once which may reduce cost over time. <br></li>
<li>All the cost of elements in Priority Queue are expended by incresing or decresing order. <br></li>
<li>Each popped element from Priority Queue will the best status. <br></li>
<li>The time complexity of Priority Queue to process n nodes will be O(nlogn) </li>
</ul>
<p>E.g. <a href="https://leetcode.com/problems/network-delay-time/" target="_blank" rel="noopener">Leetcode 743. Network Delay Time</a></p>
<figure class="highlight java"><figcaption><span>Network Delay Time</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Edge</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> target;</span><br><span class="line">    <span class="keyword">int</span> distance;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Edge</span><span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> distance)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">        <span class="keyword">this</span>.distance = distance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//BFS2 </span></span><br><span class="line"><span class="comment">//Init a node to be expanded: K</span></span><br><span class="line"><span class="comment">//Generate neighbors to each node with updated distance.</span></span><br><span class="line"><span class="comment">//Terminate will all nodes have been visited.</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">networkDelayTime</span><span class="params">(<span class="keyword">int</span>[][] times, <span class="keyword">int</span> N, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">    Map&lt;Integer, List&lt;Edge&gt;&gt; graph = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] time: times) &#123;</span><br><span class="line">        <span class="keyword">int</span> start = time[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> end = time[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> distance = time[<span class="number">2</span>];</span><br><span class="line">        graph.putIfAbsent(start, <span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">        graph.get(start).add(<span class="keyword">new</span> Edge(end, distance));</span><br><span class="line">    &#125;</span><br><span class="line">    HashMap&lt;Integer, Integer&gt; seen = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    PriorityQueue&lt;<span class="keyword">int</span>[]&gt; que = <span class="keyword">new</span> PriorityQueue&lt;<span class="keyword">int</span>[]&gt;((info1, info2)-&gt;(info1[<span class="number">0</span>] - info2[<span class="number">0</span>]));</span><br><span class="line">    que.offer(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, K&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!que.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] info = que.poll();</span><br><span class="line">        <span class="keyword">int</span> target = info[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> distance = info[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(seen.containsKey(target)) <span class="keyword">continue</span>;</span><br><span class="line">        seen.put(target, distance);</span><br><span class="line">        <span class="keyword">if</span>(graph.containsKey(target)) &#123;</span><br><span class="line">            <span class="keyword">for</span>(Edge nei: graph.get(target)) &#123;</span><br><span class="line">                que.offer(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;nei.distance + distance, nei.target&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> res = Integer.MIN_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> distance: seen.values())&#123;</span><br><span class="line">        res = Math.max(res,distance);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> seen.size() == N ? res : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>DFS (Depth First Search, back-tracking is a behavior of bfs) </li>
</ol>
<p>Normally, the problem will be solved in a recursion(Iteration will be also work).<br>Definiation 1: What does it stored on each level.<br><br>Definiation 2: How Many different states should be put on this level. <br><br>Termination condition: find a satisfied result or traverse all graph. <br><br>Data Structure: Stack, Deque.<br><br>Typical Algorithm Questions: Permutation and Combination.<br><br>For example: </p>
<ul>
<li>print all subsets of a set.</li>
<li>print all valid permutation of ‘()’</li>
<li>print all conbination of coins which total number is 99 cents.</li>
</ul>
<p>E.g. <a href="https://leetcode.com/problems/course-schedule/" target="_blank" rel="noopener">Leetcode 207. Course Schedule</a></p>
<figure class="highlight java"><figcaption><span>Course Schedule</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canFinish</span><span class="params">(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites)</span> </span>&#123;</span><br><span class="line">    Map&lt;Integer,Set&lt;Integer&gt;&gt; graph = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] relation: prerequisites) &#123;</span><br><span class="line">        <span class="keyword">int</span> start = relation[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> end = relation[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(!graph.containsKey(start)) &#123;</span><br><span class="line">            graph.put(start, <span class="keyword">new</span> HashSet&lt;&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        graph.get(start).add(end);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">boolean</span>[] path = <span class="keyword">new</span> <span class="keyword">boolean</span>[numCourses];</span><br><span class="line">    <span class="keyword">boolean</span>[] visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[numCourses];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numCourses; i++) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> res = isCycle(graph, path, visited, i);</span><br><span class="line">        <span class="keyword">if</span>(res) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isCycle</span><span class="params">(Map&lt;Integer,Set&lt;Integer&gt;&gt; graph, <span class="keyword">boolean</span>[] path, <span class="keyword">boolean</span>[] visited, <span class="keyword">int</span> curr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(visited[curr]) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(path[curr]) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    path[curr] = <span class="keyword">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">boolean</span> res = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(graph.containsKey(curr)) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> nei: graph.get(curr)) &#123;</span><br><span class="line">            res = isCycle(graph, path, visited, nei);</span><br><span class="line">            <span class="keyword">if</span> (res) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    path[curr] = <span class="keyword">false</span>;</span><br><span class="line">    visited[curr] = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="More-Algorith-Solutions"><a href="#More-Algorith-Solutions" class="headerlink" title="More Algorith Solutions"></a>More Algorith Solutions</h3><ol start="4">
<li><a href="https://en.wikipedia.org/wiki/Topological_sorting" target="_blank" rel="noopener">Topological Ordering</a></li>
</ol>
<p>The Topological Ordering of a graph is a linear ordering of its vertices such that for every directed edge uv from vertex u to vertex v, u comes before v in the ordering.</p>
<p>Normally, it could solve node relationships problems. The core idea is to count how many in-dgree and out-degree for each node. </p>
<p>E.g. <a href="https://leetcode.com/problems/course-schedule-ii/" target="_blank" rel="noopener">Leetcode 210. Course Schedule II</a></p>
<figure class="highlight java"><figcaption><span>Course Schedule II</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">int</span>[] findOrder(<span class="keyword">int</span> numCourses, <span class="keyword">int</span>[][] prerequisites) &#123;</span><br><span class="line">    Map&lt;Integer,Set&lt;Integer&gt;&gt; graph = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span>[] countIn = <span class="keyword">new</span> <span class="keyword">int</span>[numCourses];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] relation: prerequisites) &#123;</span><br><span class="line">        <span class="keyword">int</span> start = relation[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> end = relation[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(!graph.containsKey(start)) &#123;</span><br><span class="line">            graph.put(start, <span class="keyword">new</span> HashSet&lt;&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        graph.get(start).add(end);</span><br><span class="line">        countIn[end]++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Deque&lt;Integer&gt; que = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[numCourses];</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; numCourses; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(countIn[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            que.offerLast(i);</span><br><span class="line">            res[index++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!que.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> curr = que.pollFirst();</span><br><span class="line">        <span class="keyword">if</span>(graph.containsKey(curr))&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> nei: graph.get(curr)) &#123;</span><br><span class="line">                countIn[nei] --;</span><br><span class="line">                <span class="keyword">if</span>(countIn[nei] == <span class="number">0</span>) &#123;</span><br><span class="line">                    que.offerLast(nei);</span><br><span class="line">                    res[index++] = nei;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (index == numCourses) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the graph is undirected graph, we could assume that one edge could be 2 directed edges.One is in, one is out. </p>
<p>E.g. <a href="https://leetcode.com/problems/minimum-height-trees/" target="_blank" rel="noopener">Leetcode 310. Minimum Height Trees</a></p>
<figure class="highlight java"><figcaption><span>Minimum Height Trees</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">findMinHeightTrees</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span>[][] edges)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">           List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">           res.add(<span class="number">0</span>); </span><br><span class="line">           <span class="keyword">return</span> res;</span><br><span class="line">       &#125;</span><br><span class="line">       Map&lt;Integer, Set&lt;Integer&gt;&gt; graph = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">       <span class="keyword">int</span>[] countEdge = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span>[] edge : edges) &#123;</span><br><span class="line">           <span class="keyword">int</span> a = edge[<span class="number">0</span>];</span><br><span class="line">           <span class="keyword">int</span> b = edge[<span class="number">1</span>];</span><br><span class="line">           <span class="keyword">if</span>(!graph.containsKey(a)) &#123;</span><br><span class="line">               graph.put(a, <span class="keyword">new</span> HashSet&lt;&gt;());</span><br><span class="line">           &#125;</span><br><span class="line">           graph.get(a).add(b);</span><br><span class="line">           </span><br><span class="line">           <span class="keyword">if</span>(!graph.containsKey(b)) &#123;</span><br><span class="line">               graph.put(b, <span class="keyword">new</span> HashSet&lt;&gt;());</span><br><span class="line">           &#125;</span><br><span class="line">           graph.get(b).add(a);</span><br><span class="line">           countEdge[a]++;</span><br><span class="line">           countEdge[b]++;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       Deque&lt;Integer&gt; que = <span class="keyword">new</span> LinkedList();</span><br><span class="line">       List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList();</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span>(countEdge[i] == <span class="number">1</span>) &#123;</span><br><span class="line">               que.offerLast(i);</span><br><span class="line">               res.add(i);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">while</span>(!que.isEmpty()) &#123;</span><br><span class="line">           <span class="keyword">int</span> size = que.size();</span><br><span class="line">           List&lt;Integer&gt; tempRes = <span class="keyword">new</span> ArrayList();</span><br><span class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">               <span class="keyword">int</span> curr = que.pollFirst();</span><br><span class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> nei: graph.get(curr)) &#123;</span><br><span class="line">                   countEdge[nei]--;</span><br><span class="line">                   <span class="keyword">if</span>(countEdge[nei] == <span class="number">1</span>) &#123;</span><br><span class="line">                       que.offerLast(nei);</span><br><span class="line">                       tempRes.add(nei);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span>(tempRes.size() != <span class="number">0</span>) res= tempRes;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> res;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><a href="https://en.wikipedia.org/wiki/Kruskal%27s_algorithm" target="_blank" rel="noopener">Kruskal</a></li>
</ol>
<p>Kruskal is a minimum-spanning-tree algorithm which finds an edge of the least possible weight that connects any two trees in the forest.<br> In general, it is also used to check whether all nodes are connected.</p>
<p>E.g. <a href="https://leetcode.com/problems/satisfiability-of-equality-equations/" target="_blank" rel="noopener">Leetcode 990. Satisfiability of Equality Equations</a></p>
<figure class="highlight java"><figcaption><span>Satisfiability of Equality Equations</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equationsPossible</span><span class="params">(String[] equations)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] groups = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        groups[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(String equ: equations) &#123;</span><br><span class="line">     <span class="keyword">int</span> a = equ.charAt(<span class="number">0</span>) - <span class="string">'a'</span>;</span><br><span class="line">     <span class="keyword">int</span> b = equ.charAt(<span class="number">3</span>) - <span class="string">'a'</span>;</span><br><span class="line">     <span class="keyword">boolean</span> isEqual = equ.charAt(<span class="number">1</span>) == <span class="string">'='</span>;</span><br><span class="line">        <span class="keyword">if</span>(isEqual)&#123;</span><br><span class="line">            <span class="keyword">int</span> groupA = find(a, groups);</span><br><span class="line">            <span class="keyword">int</span> groupB = find(b, groups);</span><br><span class="line">            <span class="keyword">if</span>(groupA != groupB) &#123;</span><br><span class="line">                groups[groupA] = groupB;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(String equ: equations) &#123;</span><br><span class="line">     <span class="keyword">int</span> a = equ.charAt(<span class="number">0</span>) - <span class="string">'a'</span>;</span><br><span class="line">     <span class="keyword">int</span> b = equ.charAt(<span class="number">3</span>) - <span class="string">'a'</span>;</span><br><span class="line">     <span class="keyword">boolean</span> isEqual = equ.charAt(<span class="number">1</span>) == <span class="string">'='</span>;</span><br><span class="line">        <span class="keyword">if</span>(!isEqual)&#123;</span><br><span class="line">            <span class="keyword">int</span> groupA = find(a, groups);</span><br><span class="line">            <span class="keyword">int</span> groupB = find(b, groups);</span><br><span class="line">            <span class="keyword">if</span>(groupA == groupB) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span>[] groups)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a != groups[a]) &#123;</span><br><span class="line">        groups[a] = find(groups[a], groups);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> groups[a];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="6">
<li><a href="https://en.wikipedia.org/wiki/Dynamic_programming" target="_blank" rel="noopener">Dynamic Programming</a></li>
</ol>
<p>Some algorithm questions will reuqire to check node relations multiple times.DP algorithm could memorize all relationships each time. It will reduce cost.</p>
<p>E.g. <a href="https://leetcode.com/problems/find-the-city-with-the-smallest-number-of-neighbors-at-a-threshold-distance/" target="_blank" rel="noopener">Leetcode 1334. Find the City With the Smallest Number of Neighbors at a Threshold Distance</a></p>
<figure class="highlight java"><figcaption><span>Find the City With the Smallest Number of Neighbors</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DP</span></span><br><span class="line"><span class="comment">//DP[0][0] = Max_VALUE; </span></span><br><span class="line"><span class="comment">//DP[i][j] = min(DP[i][k] + DP[k][j]) where 0&lt;=k&lt;=n-1</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTheCity</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span>[][] edges, <span class="keyword">int</span> distanceThreshold)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[][] conns = <span class="keyword">new</span> <span class="keyword">int</span>[n][n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            conns[i][j] = <span class="number">9999999</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>[] edge: edges)&#123;</span><br><span class="line">        conns[edge[<span class="number">0</span>]][edge[<span class="number">1</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        conns[edge[<span class="number">1</span>]][edge[<span class="number">0</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                conns[i][j] = Math.min(conns[i][j], conns[i][k] + conns[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> resCity = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> resMinNeis = Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> totalNeis  = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (conns[i][j] &lt;= distanceThreshold) &#123;</span><br><span class="line">                totalNeis++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(totalNeis &lt;= resMinNeis) &#123;</span><br><span class="line">            resMinNeis = totalNeis;</span><br><span class="line">            resCity = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> resCity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
  
</article>

  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/DexWebSite/page/2/">2</a><a class="page-number" href="/DexWebSite/page/3/">3</a><a class="page-number" href="/DexWebSite/page/4/">4</a><a class="extend next" rel="next" href="/DexWebSite/page/2/">Next &raquo;</a>
  </nav>


</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/DexWebSite/images/dexphoto.jpg" title="personal image">
    <h3 class="avatar-name">
      
        Dexin Wang
      
    </h3>
  </div>
</div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Algorithm/">Algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Basic/">Basic</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/C-Programming-Language/">C# Programming Language</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Interview/">Interview</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Java-Programming-Language/">Java Programming Language</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Kits/">Kits</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/Object-Oriented-Design/">Object-Oriented Design</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/React-Development/">React Development</a></li><li class="category-list-item"><a class="category-list-link" href="/DexWebSite/categories/System-Design/">System Design</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/DexWebSite/archives/2019/03/">March 2019</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-5/">Design Data-Intensive Note #5</a>
          </li>
        
          <li>
            <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-4/">Design Data-Intensive Note #4</a>
          </li>
        
          <li>
            <a href="/DexWebSite/2020/10/11/Design-Data-Intensive-Note-3/">Design Data-Intensive Note #3</a>
          </li>
        
          <li>
            <a href="/DexWebSite/2020/10/10/Design-Data-Intensive-Note-2/">Design Data-Intensive Note #2</a>
          </li>
        
          <li>
            <a href="/DexWebSite/2020/10/10/Design-Data-Intensive-Applications/">Design Data-Intensive Note #1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 Dexin Wang &nbsp;&nbsp;
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;Theme <a href="https://github.com/DexDexinWang/hexo-dex">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">You are the <span id="busuanzi_value_site_pv"></span> visitor</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  <link rel="stylesheet" href="/DexWebSite/fancybox/jquery.fancybox.css">
  <script src="/DexWebSite/fancybox/jquery.fancybox.pack.js"></script>


<script src="/DexWebSite/js/script.js"></script>



    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/DexWebSite/" class="mobile-nav-link">Home</a>
  
    <a href="/DexWebSite/../PersonalWebSite/" class="mobile-nav-link">Background</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>